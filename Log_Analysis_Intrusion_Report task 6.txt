# POC-TASKS
# ğŸ“Œ Linux Security - Exploitation & Hardening (PoC)

This repository demonstrates **Log Analysis and Intrusion Detection** in Linux, including **exploitation and mitigation**.

---

## ğŸ”¹ **Task 6: Log Analysis & Intrusion Detection**

This task demonstrates how to **analyze logs for unauthorized access attempts** and implement **mitigation strategies** like `fail2ban` and automated log monitoring.

---

## âœ… **Setup: Enabling System Logging**

### **1ï¸âƒ£ Enable System Logging**

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl status systemd-journald
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl status rsyslog

â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ ls /var/log/auth.log
```

### **2ï¸âƒ£ Simulate Multiple Failed SSH Login Attempts**

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ for i in {1..5}; do ssh invaliduser@localhost; done
```

---

## âœ… **Exploit: Analyzing Logs**

### **1ï¸âƒ£ Extract Failed Login Attempts**

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ grep "Failed password" /var/log/auth.log
```

### **2ï¸âƒ£ Identify Brute-Force Attempts**

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ grep "Failed password" /var/log/auth.log | awk '{print $11}' | sort | uniq -c | sort -nr
```

### **3ï¸âƒ£ Detect Unauthorized Access**

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ grep "Invalid user" /var/log/auth.log
```

---

## âœ… **Mitigation: Implementing Security Measures**

### **1ï¸âƒ£ Install and Configure fail2ban**

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo apt update
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo apt install fail2ban

â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo nano /etc/fail2ban/jail.local
```

```plaintext
[sshd]
enabled = true
maxretry = 3
findtime = 600
bantime = 3600
```

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl restart fail2ban
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo fail2ban-client status sshd
```

### **2ï¸âƒ£ Set Up Log Monitoring**

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo apt install logwatch
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo logwatch --detail High --mailto root --service sshd
```

```
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo nano /etc/rsyslog.conf
*.* @192.168.1.200:514

â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl restart rsyslog
```

---

## âœ… **Summary**

| **Step**              | **Action**                                         | **Command**                                  |
|----------------------|-----------------------------------------------------|---------------------------------------------|
| ğŸ”¹ **Setup**          | Enable system logging                               | `sudo systemctl status systemd-journald`      |
|                      | Simulate multiple failed SSH login attempts          | `for i in {1..5}; do ssh invaliduser@localhost; done` |
| ğŸ”¹ **Exploit**        | Extract failed SSH login attempts                    | `grep "Failed password" /var/log/auth.log`   |
|                      | Identify brute-force attempts                        | `grep "Failed password" /var/log/auth.log | awk '{print $11}' | sort | uniq -c | sort -nr` |
|                      | Detect unauthorized access                           | `grep "Invalid user" /var/log/auth.log`      |
| ğŸ”¹ **Mitigation**     | Install and configure fail2ban                       | `sudo apt install fail2ban`                 |
|                      | Set up log monitoring with logwatch                  | `sudo apt install logwatch`                 |
|                      | Configure rsyslog for centralized logging            | `sudo nano /etc/rsyslog.conf`               |
|                      | Restart fail2ban and rsyslog                         | `sudo systemctl restart fail2ban` / `sudo systemctl restart rsyslog` |

---

### **END-x-**
